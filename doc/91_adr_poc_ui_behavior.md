# ADR: シミュレーション可視化/パネルドッキング/Serendie配色 PoC 方針

- **ステータス**: 承認 (2025-12-09)

## コンテキスト
- 未決事項: (1) シミュレーションログ可視化のチャート種類（折れ線/ステップチャート）、(2) 複数パネルのドッキング挙動（スナップ有無、レイアウト保存方法）、(3) Serendie テーマでのアクセント色・ハイライト色のコントラスト調整。
- UX 文書(doc/23_ux_design_document.md)と SRS(doc/11_software_requirement_specification.md) に要件を記述済みだが、具体実装の選択肢と評価基準が未確定。

## 考慮した選択肢
1. シミュレーションチャート: 折れ線チャート vs ステップチャート vs 棒＋ライン混在。
2. パネルドッキング: (a) スナップグリッド有りの簡易ドッキング、(b) ゴースト表示付きドッキングレイアウト（GoldenLayout風）、(c) ドラッグで単純リサイズのみ（現状維持）。
3. Serendie 配色: (a) 原色そのまま使用、(b) 明度/彩度を UI コンポーネントで再マッピング、(c) 背景とハイライトのみ調整。

## 決定（PoC 方針）
- 1) チャート: 折れ線とステップチャートの2種を実装し、同一データセットで切替可能にする。棒＋ラインは除外（情報過多と判断）。
- 2) パネルドッキング: スナップグリッド有りの簡易ドッキング(a)を試作し、配置状態をローカル保存する。GoldenLayout 風の複雑な分割は第2段階の検討とする。
- 3) Serendie 配色: 背景とハイライトのコントラスト調整(c)を先行。原色そのまま(a)をベースに、ハイライト/選択色のみ明度補正を行う。

## 決定の基準
- 実装コストが低く、短期で比較評価できること。
- パフォーマンス（1万セル/ノード規模での UI レスポンス）への影響が小さいこと。
- ユーザビリティ向上が定性的に確認できること（社内ユーザテストでフィードバック収集）。

## 結果・影響
- チャート: 2種類の描画コンポーネントを切替 UI に追加する必要があるが、データフォーマットは共通で実装再利用が可能。
- パネル: スナップ実装によりドラッグ/リサイズの UI ロジックを拡張。状態保存のため設定ストアにパネル座標を追加。
- 配色: テーマ定義にハイライト用トークンを追加し、Serendie 以外のテーマにも影響しない形で適用。

## 次のアクション
1. 折れ線/ステップチャートのコンポーネントを作成し、同一データで切替できる UI スイッチを追加（所要 0.5d）。
2. パネルスナップの PoC を実装し、座標保存/復元を確認（所要 1d）。
3. Serendie ハイライト色の明度補正値を 2,3 パターンで試験し、コントラスト比 (WCAG AA) を計測（所要 0.5d）。
4. 社内ユーザテストでフィードバック収集後、正式採用を別 ADR で確定。
